---
title: "Story Board Visualization"
date: "`r Sys.Date()`"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    orientation: columns
    vertical_layout: fill
    theme: united
---

```{r setup, include=FALSE}
# Loading required libraries
library(flexdashboard)
library(readr)
library(ggplot2)
library(plotly)
```

Analysis {.storyboard}
=========================================

```{r,warning=FALSE,message=FALSE,echo=FALSE}
#Setting up the data object due to issues regarding parsing of .csv file
cdt <- read_csv("C:/Users/demon/Desktop/custodial-deaths.csv")
cd<-cdt[,1:12]

newnames<-c("Department.Name", "Custody.Type", "Custody.Type.Facility","First.Name","Middle.Name","Last.Name","Ethnicity","Sex","Age","Death.Date","Manner.Death","Charges.Status")
colnames(cd)<-newnames

# Adding aditional columns
cd$AgeGroup<-""
cd$AgeGroup<-ifelse(cd$Age<=0,NA,ifelse(cd$Age<=25,"1-25",ifelse(cd$Age<=50,"26-50",ifelse(cd$Age<=75,"51-75",ifelse(cd$Age<=100,"76-100",ifelse(cd$Age<=125,"101-125","Over 125"))))))

# Modifying to work with dates effectively
date<-strptime(cd$Death.Date, "%m/%d/%Y %H:%M")
cd$Death.Date<-date
```

### The dataset contains a larger proportion of male inmates as compared to female inmates  
  
```{r,warning=FALSE,message=FALSE,echo=FALSE}
p1<-ggplot(data=cd, aes(x=Sex,fill=AgeGroup))+geom_bar(width=1)+coord_polar(theta="y")+guides(fill= guide_legend(title = "Age Group"))
p1
```  
  
***  
  
  Another observation we can make is that the male inmate distribution represents a wider range of age groups as compared to the female inmates which have a higher concentration in the 26-50 age range, followed by 51-75.  
  
### The Age at the time of death across ethnicities shows considerable variation, especially for the male population  

```{r,warning=FALSE,message=FALSE,echo=FALSE,fig.align='center',fig.height=4,fig.width=7}
p2<-ggplot(data = cd, aes(x=Sex, y=Age, colour=Ethnicity, title("Age wise distribution")))+geom_boxplot()+coord_flip()+scale_color_brewer(palette = "Paired")+theme_dark()
p2
```  

***  
  
  + Another detail we can notice is that there are a few cases in which the age at the time of death was not recorded, specifically in the cases of __African-American__, __Anglo__ and __Hispanic__. There is also one case in the category of unknown ethnicity.
  + Another interesting observation that sticks out is that the inmates of __Native Hawaiin/Pacific Islander__ ethnicity shows a small group of 26-50 year olds dying over the years.
  + We can also observe that in the case of female inmates, the only ethnicities observed were __African-American__, __Anglo__ and __Hispanic__.  
  
### On a per year basis, however,the number of deaths by ethnicity shows that the majority of deaths happen to inmates of __Anglo__ ethnicity   

```{r,warning=FALSE,message=FALSE,echo=FALSE,fig.align='center',fig.height=4,fig.width=7}
p3<-ggplot(data = cd, aes(x=factor(format(Death.Date, '%Y')) ,fill=Ethnicity))+geom_bar(position = "dodge")+scale_fill_brewer(palette = "Paired")+xlab("Year")+theme_dark()
p3
```  

***  
  
  + We can also observe that second most number of deaths was initially of the __African-American__ ethnicity, but it saw a gradual drop in 2011. After 2011, the second most number of deaths varies mainly between __African-American__ and __Hispanic__ ethnicities.
  +We can also see that 2015 saw the most number of deaths of __Anglo__ ethnicity.  
  
### Many inmates of the dataset primarily passed away at a penitentiary, while muncipal jails saw the least number of deaths  

```{r,warning=FALSE,message=FALSE,echo=FALSE,fig.align='center',fig.height=4,fig.width=7}
p4<-ggplot(data= cd, aes(x=factor(format(Death.Date, '%Y')),fill=Custody.Type))+geom_bar(position="dodge")+scale_fill_brewer()+guides(fill= guide_legend(title = "Custody Type"))+xlab("Year")+theme_dark()
p4
```  

***  
  
  + It's interesting to note that a number of deaths have taken place in police custody as compared to Muncipal Jails and County Jails. 
  +We would generally expect most deaths to happen in penitentiaries due to a number of prisoners serving life sentences or being executed there.
  +The most interesting fact is that in recent years the number of deaths in Police Custody have increased quite a bit.  
  
### In the case of __Penitentiaries__ and __County Jails__, the majority of deaths are due to __Natural Causes or Illness__ with __Penitentiaries__ accounting for most of these deaths  

```{r,warning=FALSE,message=FALSE,echo=FALSE,fig.align='center',fig.height=4,fig.width=11}
p6<-ggplot(data=cd, aes(x=factor(format(Death.Date, '%Y')),fill=Manner.Death))+geom_bar(position = "dodge")+scale_fill_brewer(palette = "Greens")+guides(fill= guide_legend(title = "Manner of Death"))+xlab("Year")+facet_wrap(~Custody.Type)+theme_dark()
p6
```  

***  
  
  + Another aspect we can observe is that the number of deaths in __Police Custody__ that are classified as __Justfiable Homicide__ are quite high, even when compared to other institutions.
  + Again, we see that __Muncipal Jails__ account for a few deaths comparatively.  
  
### For deaths in __Police Custody__ that have been deemed as __Justfiable Homicide__, a larger number of such deaths took place in 2013   

```{r,warning=FALSE,message=FALSE,echo=FALSE,fig.align='center',fig.height=4,fig.width=7}
# Subsetting data for construction of next visualization 
cdt1<-cd[cd$Custody.Type=="Police Custody (pre-booking)" & cd$Manner.Death=="Justifiable Homicide",]
  
# Plotting data
p5<-ggplot(data=cdt1, aes(x=factor(format(Death.Date, '%Y')),fill=Ethnicity))+geom_bar(position="dodge")+scale_fill_brewer(palette = "Paired")+xlab("Year")+theme_dark()
p5
```  

***  
  
  + We can also see that  initially, such deaths would happen more often to inmates of __Hispanic__ ethnicity but later years saw more of a blance between __Anglo__ and __Hispanic__ ethnicities.
  + It is interesting to see that the inmates whose ethnicity was classified as __Other/Don't Know__ have dates of death only in the year 2015.
  + Another observation that can be made is that the number of deaths of __Anglo__ ethnicity inmates, whose death was classified as __Justifiable Homicide__, seemd to have spiked to the highest amount in 2013 (which is the most number of such deaths across ethnicities).  
  
Details
=========================================

Column
-----------------------------------------

### Team Members:  
  + Ashish Syal
  + Dean D'souza
  + SoujanyaPrakash Bulagannawar
  
  